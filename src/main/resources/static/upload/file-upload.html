<!DOCTYPE html>
<html>
<head>
    <title>大文件分片上传</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.6.4/jquery.js"></script>
    <script type="text/javascript" src="FileS3Upload.js"></script>
</head>
<body>
<h1>测试大文件分片上传</h1>
<div>
    <h2>Demo</h2>
    <input type="file" id="files" />
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('#files').change(function (evt) {
            var file = evt.target.files[0];

            var fileUploadTest = new FileS3Upload({
                aws_url: "http://192.168.30.23/school-repo",
                file_name: file.name,
                file: file,
                auth_url: "http://localhost:8080/signv4_auth",
                bucket: "school-repo",
                aws_key_id: "U2A27HEBIS06RIF3JOBC",
                auth_url_headers: {},
                on_get_upload_id: function (xhr, uploadId) {
                    console.log("获取uploadLoadId回调：uploadId=" + uploadId);
                },
                on_progress: function (total, loaded) {
                    console.log("上传进度变更回调：upload percent=" + (loaded / total * 100).toFixed(2) + "%");
                },
                on_part_upload: function (xhr, ETag, current_part) {
                    console.log("上传分片成功回调：ETag=" + ETag + "; current_part=" + current_part);
                },
                on_multipart_upload_complete: function (xhr) {
                    console.log("上传成功");
                }
            });

            fileUploadTest.init_multipart_upload();
        });
    });
</script>
</body>
</html>
